

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Scraping Regattas…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    pre { white-space: pre-wrap; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-b from-blue-700 to-blue-400 text-white p-4">
  <div class="max-w-3xl w-full bg-white text-gray-800 rounded-xl shadow-lg p-6">
    <h1 class="text-2xl font-bold mb-2">⏳ Running Resume.py…</h1>
    <p class="mb-4 text-gray-600">This may take a few minutes. Output will appear below:</p>
    <pre id="log" class="bg-gray-100 p-4 rounded-lg h-96 overflow-y-auto"></pre>


    <!-- Hidden until done -->
    <div id="continue-container" class="mt-6 hidden">
      <a id="continue-link"
         class="bg-blue-700 hover:bg-blue-800 text-white font-semibold py-3 px-6 rounded-xl text-lg"
         href="#">
        Continue
      </a>
    </div>
  </div>


  <script>
    const log = document.getElementById("log");
    const continueContainer = document.getElementById("continue-container");
    const continueLink = document.getElementById("continue-link");


    const sseUrl = "{{ url_for('stream_log') }}" + window.location.search;
    const evtSource = new EventSource(sseUrl);


    evtSource.onmessage = (e) => {
      log.textContent += e.data + "\n";
      log.scrollTop = log.scrollHeight;
    };


    evtSource.addEventListener("done", () => {
      evtSource.close();
      log.textContent += "\n✅ Finished running Resume.py.\n";
      continueLink.href = "{{ url_for('completed_page') }}" + window.location.search;
      continueContainer.classList.remove("hidden");
    });


    evtSource.onerror = () => {
      evtSource.close();
      log.textContent += "\n❌ Error streaming logs (connection closed).";
    };
  </script>
</body>
</html>


